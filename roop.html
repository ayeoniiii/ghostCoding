<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3일 여행 루틴 앱</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for smooth progress bar animation */
        .progress-circle {
            transform: rotate(-90deg);
        }
        .progress-bar {
            transition: stroke-dashoffset 0.5s ease-in-out;
        }
        
        /* Font: Inter (Tailwind default) */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent; /* Remove tap highlight on mobile */
        }
    </style>
</head>
<body class="bg-gray-50">

    <!-- 메인 컨테이너 -->
    <div id="app" class="min-h-screen flex flex-col max-w-lg mx-auto">
        <!-- UI는 JavaScript에 의해 여기에 렌더링됩니다. -->
    </div>

    <script>
        // 루틴 데이터 정의 (React 코드와 동일)
        const ALL_ROUTINES = [
            { id: 101, text: "새로운 경험 찾기", day: 1, category: "Explore", icon: 'Plane' },
            { id: 102, text: "오늘의 여행 기록하기", day: 1, category: "Record", icon: 'Camera' },
            { id: 103, text: "낯선 곳에서 아침 식사", day: 1, category: "Nourish", icon: 'Utensils' },
            { id: 201, text: "현지인처럼 대화 시도하기", day: 2, category: "Connect", icon: 'BookOpen' },
            { id: 202, text: "숨겨진 골목길 탐험", day: 2, category: "Explore", icon: 'Compass' },
            { id: 203, text: "여행의 의미 되새기기", day: 2, category: "Reflect", icon: 'BookOpen' },
            { id: 301, text: "다음 여정 계획 세우기", day: 3, category: "Plan", icon: 'Plane' },
            { id: 302, text: "여행 중 감사했던 일 3가지 작성", day: 3, category: "Record", icon: 'Camera' },
            { id: 303, text: "기념품은 추억으로 대체", day: 3, category: "Simplify", icon: 'Luggage' },
        ];

        // 상태 관리 (전역 변수)
        let currentDay = 1; // 1, 2, 3
        let completedRoutines = new Set([102]); // 초기 완료 루틴
        let activeTab = '3-day'; // '3-day' 또는 'all'
        
        const appContainer = document.getElementById('app');

        // Lucide Icon SVG 정의 (인라인 사용을 위해)
        const icons = {
            Plane: `<path d="M17.8 19.2 20.3 22l-1.3-1.4-2.5-2.6h-7.6a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2h10.4a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-10.4z"/><path d="m2 16 1.8-1.8m4.4-4.4L10 6 12 4l2 2 2.2 2.2"/>`,
            Camera: `<path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/>`,
            Utensils: `<path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2M7 2v20M20 2v7c0 1.1-.9 2-2 2h-4a2 2 0 0 1-2-2V2M16 2v20"/>`,
            BookOpen: `<path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>`,
            Compass: `<circle cx="12" cy="12" r="10"/><path d="m16.24 7.76-2.12 6.36-6.36 2.12 2.12-6.36 6.36-2.12z"/>`,
            Luggage: `<rect x="6" y="8" width="12" height="13" rx="2" ry="2"/><path d="M8 6h8a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2zM12 2v4M12 17v-4"/>`,
            Check: `<path d="M20 6 9 17l-5-5"/>`,
            Home: `<path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>`,
            Gauge: `<path d="M12 14v4M10 20.7a10 10 0 1 1 4 0"/>`,
            User: `<path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/>`,
        };

        /**
         * 아이콘 이름과 클래스를 받아 SVG 문자열을 반환합니다.
         */
        function getIcon(name, classes, strokeWidth = 2) {
            const svgContent = icons[name] || '';
            if (!svgContent) return '';
            
            return `
                <svg xmlns="http://www.w3.org/2000/svg" class="${classes}" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="${strokeWidth}" stroke-linecap="round" stroke-linejoin="round">
                    ${svgContent}
                </svg>
            `;
        }
        
        /**
         * 루틴 완료/취소 상태를 토글합니다.
         */
        function toggleCompletion(id) {
            if (completedRoutines.has(id)) {
                completedRoutines.delete(id);
            } else {
                completedRoutines.add(id);
            }
            renderApp(); // 상태 변경 후 앱 전체를 다시 렌더링
        }

        /**
         * 다음 일차로 이동하거나 새 루프(1일차)를 시작합니다.
         */
        function goToNextDay() {
            if (currentDay === 3) {
                currentDay = 1;
                // 새 루프 시작 시 완료 목록 초기화 (선택 사항)
                // completedRoutines = new Set(); 
            } else {
                currentDay += 1;
            }
            renderApp();
        }

        /**
         * 현재 루프의 전체 완료율을 계산합니다.
         */
        function calculateOverallProgress() {
            const totalRoutinesOverall = ALL_ROUTINES.length;
            const completedRoutinesOverall = ALL_ROUTINES.filter(r => completedRoutines.has(r.id)).length;
            const percent = totalRoutinesOverall > 0 ? (completedRoutinesOverall / totalRoutinesOverall) * 100 : 0;
            return { percent, completedCount: completedRoutinesOverall, totalCount: totalRoutinesOverall };
        }

        /**
         * 원형 진행 표시줄 HTML을 생성합니다.
         */
        function renderCircularProgress(percent, day, completedCount) {
            const radius = 50;
            const circumference = 2 * Math.PI * radius;
            const offset = circumference - (percent / 100) * circumference;

            return `
                <div class="relative flex items-center justify-center w-32 h-32 md:w-40 md:h-40">
                    <svg class="w-full h-full progress-circle" viewBox="0 0 120 120">
                        <!-- 배경 원 -->
                        <circle cx="60" cy="60" r="${radius}" fill="none" stroke="#e0e7ff" stroke-width="8" />
                        <!-- 진행 원 -->
                        <circle
                            cx="60"
                            cy="60"
                            r="${radius}"
                            fill="none"
                            stroke="#4f46e5"
                            stroke-width="8"
                            stroke-linecap="round"
                            stroke-dasharray="${circumference}"
                            stroke-dashoffset="${offset}"
                            class="progress-bar"
                        />
                    </svg>
                    <div class="absolute flex flex-col items-center justify-center">
                        ${getIcon('Luggage', 'text-indigo-600 w-7 h-7 md:w-8 md:h-8', 1.5)}
                        <span class="mt-1 text-2xl font-bold text-indigo-600 md:text-3xl">${day}일차</span>
                        <span class="text-sm font-medium text-gray-500 md:text-base">${Math.round(percent)}% 완료</span>
                    </div>
                </div>
            `;
        }

        /**
         * 루틴 아이템 HTML을 생성합니다.
         */
        function renderRoutineItem(routine) {
            const isCompleted = completedRoutines.has(routine.id);
            
            const itemClasses = isCompleted
                ? 'bg-indigo-50 border-l-4 border-indigo-600'
                : 'bg-white hover:bg-gray-50';
            
            const iconBgClass = isCompleted ? 'bg-indigo-200' : 'bg-gray-100';
            const iconColorClass = isCompleted ? 'text-indigo-700' : 'text-gray-600';
            
            const textClasses = isCompleted
                ? 'text-gray-600 line-through'
                : 'text-gray-800';

            return `
                <div 
                    class="flex items-center justify-between p-4 mb-3 transition duration-300 rounded-xl shadow-md cursor-pointer ${itemClasses}"
                    onclick="toggleCompletion(${routine.id})"
                >
                    <div class="flex items-center">
                        <div class="p-3 mr-4 rounded-full ${iconBgClass}">
                            ${getIcon(routine.icon, `w-5 h-5 ${iconColorClass}`)}
                        </div>
                        <div>
                            <p class="font-semibold text-lg ${textClasses}">
                                ${routine.text}
                            </p>
                            <p class="text-sm text-gray-400">Day ${routine.day} - ${routine.category}</p>
                        </div>
                    </div>
                    <div class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition ${isCompleted ? 'bg-indigo-600 border-indigo-600' : 'border-gray-300'}">
                        ${isCompleted ? getIcon('Check', 'w-4 h-4 text-white', 3) : ''}
                    </div>
                </div>
            `;
        }

        /**
         * 루틴 리스트 섹션 HTML을 생성합니다.
         */
        function renderRoutineList() {
            if (activeTab === '3-day') {
                const groupedRoutines = ALL_ROUTINES.reduce((acc, routine) => {
                    (acc[routine.day] = acc[routine.day] || []).push(routine);
                    return acc;
                }, {});

                let html = '<div class="space-y-6">';
                for (const day in groupedRoutines) {
                    html += `
                        <div>
                            <h3 class="text-xl font-bold text-gray-700 mb-3 ml-2">여정 ${day}일차 (Day ${day})</h3>
                            ${groupedRoutines[day].map(renderRoutineItem).join('')}
                        </div>
                    `;
                }
                html += '</div>';
                return html;
            } else if (activeTab === 'all') {
                return `
                    <div class="space-y-4">
                        <p class="text-gray-500 text-center py-4">
                            전체 루틴 목록이 여기에 표시됩니다.
                        </p>
                        ${ALL_ROUTINES.map(renderRoutineItem).join('')}
                    </div>
                `;
            }
            return '';
        }

        /**
         * 하단 네비게이션 아이템 HTML을 생성합니다.
         */
        function renderNavItem(iconName, label, isActive) {
            const classes = isActive 
                ? 'text-indigo-600' 
                : 'text-gray-500 hover:text-indigo-500';
            
            return `
                <button class="flex flex-col items-center p-2 rounded-xl transition duration-200 ${classes}">
                    ${getIcon(iconName, 'w-6 h-6')}
                    <span class="text-xs font-medium mt-1">${label}</span>
                </button>
            `;
        }

        /**
         * 메인 앱 UI 전체를 렌더링합니다.
         */
        function renderApp() {
            const { percent, completedCount, totalCount } = calculateOverallProgress();
            
            // 앱 전체 HTML 구조
            appContainer.innerHTML = `
                <!-- 상단 헤더 -->
                <header class="p-5 pb-8 bg-white shadow-sm sticky top-0 z-10">
                    <div class="flex items-center justify-between">
                        <h1 class="text-3xl font-extrabold text-gray-900">
                            여정 <span class="text-indigo-600">${currentDay}일차</span>
                        </h1>
                        <button 
                            onclick="goToNextDay()"
                            class="px-4 py-2 text-sm font-medium text-white bg-indigo-500 rounded-full shadow-md hover:bg-indigo-600 transition"
                        >
                            ${currentDay === 3 ? '새 루프 시작' : `다음 날(${currentDay + 1}일차)로 이동`}
                        </button>
                    </div>
                </header>

                <main class="flex-grow p-4 md:p-6 pb-24">
                    
                    <!-- 원형 진행 표시줄 영역 -->
                    <div class="flex flex-col items-center justify-center p-6 mb-8 bg-white rounded-2xl shadow-lg">
                        <h2 class="text-lg font-semibold text-gray-700 mb-4">현재 루프 진행 상황</h2>
                        ${renderCircularProgress(percent, currentDay, completedCount)}
                        <p class="mt-4 text-center text-gray-500 text-sm">
                            3일 루프 중 ${completedCount}개 루틴 완료.
                            <br/>다음 여정까지 화이팅!
                        </p>
                    </div>

                    <!-- 탭 네비게이션 -->
                    <div class="flex justify-around p-1 mb-6 bg-gray-200 rounded-full shadow-inner">
                        <button
                            class="w-1/2 py-2 text-lg font-bold transition duration-300 rounded-full ${activeTab === '3-day' ? 'bg-white text-indigo-600 shadow-md' : 'text-gray-600'}"
                            onclick="setActiveTab('3-day')"
                        >
                            3일 루틴
                        </button>
                        <button
                            class="w-1/2 py-2 text-lg font-bold transition duration-300 rounded-full ${activeTab === 'all' ? 'bg-white text-indigo-600 shadow-md' : 'text-gray-600'}"
                            onclick="setActiveTab('all')"
                        >
                            전체 루틴
                        </button>
                    </div>

                    <!-- 루틴 리스트 -->
                    ${renderRoutineList()}
                </main>

                <!-- 하단 네비게이션 바 -->
                <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-2xl">
                    <div class="flex justify-around items-center h-16 max-w-lg mx-auto">
                        ${renderNavItem('Home', '홈', true)}
                        ${renderNavItem('Gauge', '진행', false)}
                        ${renderNavItem('Compass', '여정', false)}
                        ${renderNavItem('User', '프로필', false)}
                    </div>
                </nav>
            `;
        }
        
        /**
         * 탭 상태를 변경하고 앱을 다시 렌더링합니다.
         */
        function setActiveTab(tab) {
            activeTab = tab;
            renderApp();
        }


        // 페이지 로드 시 앱 초기 렌더링
        window.onload = renderApp;
    </script>
</body>
</html>